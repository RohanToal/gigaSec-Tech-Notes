[[MOC Cybersecurity]]

# Orbit Linux Malware that hijacks Execution Flow
Created:  [[2022-07-08]]
Tags: #fleeting 

---
It temporarily stores output of executed command commands ("tmp/.orbit")

"Can be installed with persistence capabilities or as a volatile implant"
Securit researcher Nicole Fishbein said:

Has advanced evasion techniques and gains persistence on machines
- Hookey key functions
It provides threat actor with remote access capabilities over SSH, harvests credentials and logs TTY comands


OrBit is the fourth Linux malware to have come to light in a short span of three months after [BPFDoor](https://thehackernews.com/2022/06/quick-and-simple-bpfdoor-explained.html), [Symbiote](https://thehackernews.com/2022/06/symbiote-stealthy-linux-malware.html), and [Syslogk](https://thehackernews.com/2022/06/new-syslogk-linux-rootkit-lets.html).

Designed a lot like Symbiote
- Infects all of running processes on the compromised machine

But unlike the latter which leverages the [LD_PRELOAD environment variable](https://help.ubuntu.com/community/EnvironmentVariables) to load the shared object, OrBit employs two different methods.



The first way is by adding the shared object to the configuration file that is used by the loader. Second way is by patching the binary of the loader itself so it will load the malicious shared object.

Questions for above line
#myquestion What is shared object here?
#myquestion Also, what does loader mean?

The attack chain commences with an [ELF dropper](https://www.virustotal.com/gui/file/f1612924814ac73339f777b48b0de28b716d606e142d4d3f4308ec648e3f56c8) file that's responsible for extracting the [payload](https://www.virustotal.com/gui/file/40b5127c8cf9d6bec4dbeb61ba766a95c7b2d0cafafcb82ede5a3a679a3e3020) ("libdl.so") and adding it to the shared libaries that are being loaded by the [dynamic linker](https://en.wikipedia.org/wiki/Dynamic_linker).

The rogue shared library is engineered to [hook functions](https://www.netspi.com/blog/technical/network-penetration-testing/function-hooking-part-i-hooking-shared-library-function-calls-in-linux/) from three libraries â€” libc, libcap, and Pluggable Authentication Module (PAM)
- essentially permitting to harvest credentials
- hide network activity
- set up remote access to the host over SSH

OrBit relies on a barrage of methods that allows it to function without alerting its presence and establish persistence in a manner that makes it difficult to remove from the infected machines.


Once engaged, the backdoor's 
ultimate goal is steal information by hooking the read and write functions to capture data that's being written by the executed processes on the machine, including bash and sh commands, the results of which are stored in specific files.













### References
1. 
https://thehackernews.com/2022/07/researchers-warn-of-new-orbit-linux.html